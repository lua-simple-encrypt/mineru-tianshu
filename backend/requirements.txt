# ============================================================================
# Core Frameworks (已在 Dockerfile 中处理，这里列出用于约束)
# ============================================================================
paddlepaddle-gpu==3.3.0
# [关键] 锁定 protobuf 以兼容 Paddle 和 Transformers
protobuf==3.20.3

# ============================================================================
# MinerU & OCR Core
# ============================================================================
mineru[core]>=2.7.6
# [修复] 0.0.4 需要 albumentations>=1.4.11
doclayout-yolo>=0.0.2
ftfy>=6.1.0
paddleocr>=2.8.0

# ============================================================================
# Transformers & Tokenizers
# ============================================================================
# [修复] 匹配 transformers 4.57.6 的依赖要求
transformers==4.57.6
tokenizers>=0.22.0

# ============================================================================
# MinerU 缺失的依赖补全 (Missing Dependencies)
# ============================================================================
mineru-vl-utils>=0.1.19.1,<1
qwen-vl-utils>=0.0.14,<1
pdftext>=0.6.3
pypdfium2>=4.30.0
fast-langdetect>=0.2.3,<0.3.0
json-repair>=0.46.2
magika>=0.6.2,<1.1.0
shapely>=2.0.7,<3
pyclipper>=1.3.0,<2
omegaconf>=2.3.0,<3
accelerate>=1.5.1
onnxruntime>=1.17.0

# ============================================================================
# Image Processing
# ============================================================================
PyMuPDF>=1.24.0
Pillow>=11.0.0
img2pdf>=0.5.0
pikepdf>=9.0.0

# [关键修复] 解决 doclayout-yolo 冲突
albumentations>=1.4.11
# [关键修复] 必须限制 scikit-image 版本，否则它会拉取 Numpy 2.0 导致 Numba 崩溃
scikit-image>=0.25.0,<0.26.0

kiwisolver>=1.4.5
matplotlib>=3.9.0
contourpy>=1.3.0

# ============================================================================
# Audio & Video
# ============================================================================
funasr>=1.2.7
ffmpeg-python>=0.2.0
soundfile>=0.12.0
imagehash>=4.3.0

# [关键修复] 强制使用 headless 版本避免与 vLLM 冲突，且适合服务器环境
# 替换原本的 opencv-python
opencv-python-headless>=4.10.0

# [关键修复] 严防 Numpy 2.0 (Numba 和 vLLM 目前都不支持 Numpy 2)
numpy>=1.26.0,<2.0.0

# ============================================================================
# Bioinformatics & Other Utils
# ============================================================================
biopython>=1.80
ultralytics>=8.3.0
simple-lama-inpainting>=0.1.0
huggingface-hub>=0.23.2
modelscope>=1.18.0
safetensors>=0.7.0

# ============================================================================
# Web Framework & API
# ============================================================================
fastapi==0.115.6
uvicorn[standard]==0.34.0
python-multipart>=0.0.9
litserve==0.2.16
aiohttp==3.11.11

# ============================================================================
# Auth & Utils
# ============================================================================
pyjwt>=2.9.0
authlib>=1.3.0
python3-saml>=1.16.0
pydantic[email]==2.10.5
pydantic-core==2.27.2
email-validator>=2.2.0
loguru>=0.7.0
python-dotenv>=1.0.0
markitdown[all]>=0.1.3
minio>=7.2.0
redis>=5.0.0

# ============================================================================
# MCP Protocol
# ============================================================================
mcp==1.1.2
sse-starlette==2.2.1
jsonschema>=4.20.0
jsonschema-specifications>=2023.12.1

# ============================================================================
# Build Tools
# ============================================================================
typing-extensions>=4.12.0
setuptools>=75.0.0
lxml>=5.3.0
